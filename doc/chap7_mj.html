<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<script type="text/javascript"
  src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<title>GAP (digraphs) - Chapter 7: Homomorphisms</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="generator" content="GAPDoc2HTML" />
<link rel="stylesheet" type="text/css" href="manual.css" />
<script src="manual.js" type="text/javascript"></script>
<script type="text/javascript">overwriteStyle();</script>
</head>
<body class="chap7"  onload="jscontent()">


<div class="chlinktop"><span class="chlink1">Goto Chapter: </span><a href="chap0_mj.html">Top</a>  <a href="chap1_mj.html">1</a>  <a href="chap2_mj.html">2</a>  <a href="chap3_mj.html">3</a>  <a href="chap4_mj.html">4</a>  <a href="chap5_mj.html">5</a>  <a href="chap6_mj.html">6</a>  <a href="chap7_mj.html">7</a>  <a href="chap8_mj.html">8</a>  <a href="chap9_mj.html">9</a>  <a href="chapA_mj.html">A</a>  <a href="chapBib_mj.html">Bib</a>  <a href="chapInd_mj.html">Ind</a>  </div>

<div class="chlinkprevnexttop">&nbsp;<a href="chap0_mj.html">[Top of Book]</a>&nbsp;  <a href="chap0_mj.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap6_mj.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap8_mj.html">[Next Chapter]</a>&nbsp;  </div>

<p id="mathjaxlink" class="pcenter"><a href="chap7.html">[MathJax off]</a></p>
<p><a id="X84975388859F203D" name="X84975388859F203D"></a></p>
<div class="ChapSects"><a href="chap7_mj.html#X84975388859F203D">7 <span class="Heading">Homomorphisms</span></a>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap7_mj.html#X8200192B80AD2071">7.1 <span class="Heading">Acting on digraphs</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X808972017C486F1F">7.1-1 OnDigraphs</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7AFBA7608498F9CE">7.1-2 OnMultiDigraphs</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap7_mj.html#X7E48B9F87A0F22D4">7.2 <span class="Heading">Isomorphisms and canonical labellings</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X83E593F3855B122E">7.2-1 DigraphsUseNauty</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X858C32127A190175">7.2-2 AutomorphismGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X8710D68486A0F44B">7.2-3 BlissAutomorphismGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X857758B18144C0CD">7.2-4 NautyAutomorphismGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X877732B1783C391B">7.2-5 AutomorphismGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7D676FE67A6684FF">7.2-6 BlissCanonicalLabelling</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X87DA265D803DB337">7.2-7 BlissCanonicalLabelling</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X877B1D377EC197D7">7.2-8 BlissCanonicalDigraph</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X803ACEDA7BBAC5B3">7.2-9 DigraphGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X8096C5287E459279">7.2-10 DigraphOrbits</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X8386028782F2D3FF">7.2-11 DigraphOrbitReps</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X8657604E87A25E5F">7.2-12 DigraphSchreierVector</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X78913684795FB256">7.2-13 DigraphStabilizer</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7B4F24B283C9EE28">7.2-14 IsIsomorphicDigraph</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7D4A1FA8868DA930">7.2-15 IsIsomorphicDigraph</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X8219FE6C839D9457">7.2-16 IsomorphismDigraphs</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7ED93C0F86D9D34F">7.2-17 IsomorphismDigraphs</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7E1C806D81DFE15E">7.2-18 RepresentativeOutNeighbours</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap7_mj.html#X7E1A02FE8384C03C">7.3 <span class="Heading">Homomorphisms of digraphs</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X79ABF0E783FD67C7">7.3-1 HomomorphismDigraphsFinder</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X85E9B019877AD7FE">7.3-2 DigraphHomomorphism</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X8653EDA183E06D05">7.3-3 HomomorphismsDigraphs</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X82D0FCD87D47ACA8">7.3-4 DigraphMonomorphism</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X84B4BDB984C2A9A8">7.3-5 MonomorphismsDigraphs</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7CB5AD9F861684FD">7.3-6 DigraphEpimorphism</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7DFB1F5D873937B3">7.3-7 EpimorphismsDigraphs</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7E93B268823F6478">7.3-8 GeneratorsOfEndomorphismMonoid</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X86D0A74B83D6B9A7">7.3-9 DigraphColouring</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X7AD04CC186E86CCA">7.3-10 DigraphEmbedding</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap7_mj.html#X807D49358529A37C">7.3-11 ChromaticNumber</a></span>
</div></div>
</div>

<h3>7 <span class="Heading">Homomorphisms</span></h3>

<p><a id="X8200192B80AD2071" name="X8200192B80AD2071"></a></p>

<h4>7.1 <span class="Heading">Acting on digraphs</span></h4>

<p><a id="X808972017C486F1F" name="X808972017C486F1F"></a></p>

<h5>7.1-1 OnDigraphs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; OnDigraphs</code>( <var class="Arg">digraph</var>, <var class="Arg">perm</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; OnDigraphs</code>( <var class="Arg">digraph</var>, <var class="Arg">trans</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A digraph.</p>

<p>If <var class="Arg">digraph</var> is a digraph, and the second argument <var class="Arg">perm</var> is a <em>permutation</em> of the vertices of <var class="Arg">digraph</var>, then this operation returns a digraph constructed by relabelling the vertices of <var class="Arg">digraph</var> according to <var class="Arg">perm</var>. Note that for an automorphism <code class="code">f</code> of a digraph, we have <code class="code">OnDigraphs(<var class="Arg">digraph</var>, f) = </code><var class="Arg">digraph</var>.</p>

<p>If the second argument is a <em>transformation</em> <var class="Arg">trans</var> of the vertices of <var class="Arg">digraph</var>, then this operation returns a digraph constructed by transforming the source and range of each edge according to <var class="Arg">trans</var>. Thus a vertex which does not appear in the image of <var class="Arg">trans</var> will be isolated in the returned digraph, and the returned digraph may contain multiple edges, even if <var class="Arg">digraph</var> does not. If <var class="Arg">trans</var> is mathematically a permutation, then the result coincides with <code class="code">OnDigraphs(<var class="Arg">digraph</var>, AsPermutation(<var class="Arg">trans</var>))</code>.</p>

<p>The <code class="func">DigraphVertexLabels</code> (<a href="chap5_mj.html#X7E51F2FE87140B32"><span class="RefLink">5.1-9</span></a>) of <var class="Arg">digraph</var> will not be retained in the returned digraph.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := Digraph([[3], [1, 3, 5], [1], [1, 2, 4], [2, 3, 5]]);</span>
&lt;digraph with 5 vertices, 11 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">new := OnDigraphs(gr, (1, 2));</span>
&lt;digraph with 5 vertices, 11 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OutNeighbours(new);</span>
[ [ 2, 3, 5 ], [ 3 ], [ 2 ], [ 2, 1, 4 ], [ 1, 3, 5 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := Digraph([[2], [], [2]]);</span>
&lt;digraph with 3 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">t := Transformation([1, 2, 1]);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">new := OnDigraphs(gr, t);</span>
&lt;multidigraph with 3 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OutNeighbours(new);</span>
[ [ 2, 2 ], [  ], [  ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ForAll(DigraphEdges(gr),</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> e -&gt; IsDigraphEdge(new, [e[1] ^ t, e[2] ^ t]));</span>
true
</pre></div>

<p><a id="X7AFBA7608498F9CE" name="X7AFBA7608498F9CE"></a></p>

<h5>7.1-2 OnMultiDigraphs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; OnMultiDigraphs</code>( <var class="Arg">digraph</var>, <var class="Arg">pair</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; OnMultiDigraphs</code>( <var class="Arg">digraph</var>, <var class="Arg">perm1</var>, <var class="Arg">perm2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A digraph.</p>

<p>If <var class="Arg">digraph</var> is a digraph, and <var class="Arg">pair</var> is a pair consisting of a permutation of the vertices and a permutation of the edges of <var class="Arg">digraph</var>, then this operation returns a digraph constructed by relabelling the vertices and edges of <var class="Arg">digraph</var> according to <var class="Arg">perm[1]</var> and <var class="Arg">perm[2]</var>, respectively.</p>

<p>In its second form, <code class="code">OnMultiDigraphs</code> returns a digraph with vertices and edges permuted by <var class="Arg">perm1</var> and <var class="Arg">perm2</var>, respectively.</p>

<p>Note that <code class="code">OnDigraphs(<var class="Arg">digraph</var>, perm)=OnMultiDigraphs(<var class="Arg">digraph</var>, [perm, ()])</code> where <code class="code">perm</code> is a permutation of the vertices of <var class="Arg">digraph</var>. If you are only interested in the action of a permutation on the vertices of a digraph, then you can use <code class="code">OnDigraphs</code> instead of <code class="code">OnMultiDigraphs</code>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr1 := Digraph([</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[3, 6, 3], [], [3], [9, 10], [9], [],  [], [10, 4, 10], [], []]);</span>
&lt;multidigraph with 10 vertices, 10 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p := BlissCanonicalLabelling(gr1);</span>
[ (1,9,5,3,10,6,4,7), (1,7,9,5,2,8,4,10,3,6) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := OnMultiDigraphs(gr1, p);</span>
&lt;multidigraph with 10 vertices, 10 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OutNeighbours(gr2);</span>
[ [  ], [  ], [ 5 ], [  ], [  ], [  ], [ 5, 6 ], [ 6, 7, 6 ], 
  [ 10, 4, 10 ], [ 10 ] ]</pre></div>

<p><a id="X7E48B9F87A0F22D4" name="X7E48B9F87A0F22D4"></a></p>

<h4>7.2 <span class="Heading">Isomorphisms and canonical labellings</span></h4>

<p>From version 0.11.0 of <strong class="pkg">Digraphs</strong> it is possible to use either <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> or <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> (via <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span>) to calculate canonical labellings and automorphism groups of digraphs; see <a href="chapBib_mj.html#biBJunttilaKaski">[JK07]</a> and <a href="chapBib_mj.html#biBMcKay201494">[MP14]</a> for more details about <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> and <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span>, respectively.</p>

<p><a id="X83E593F3855B122E" name="X83E593F3855B122E"></a></p>

<h5>7.2-1 DigraphsUseNauty</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphsUseNauty</code>(  )</td><td class="tdright">( function )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphsUseBliss</code>(  )</td><td class="tdright">( function )</td></tr></table></div>
<p>Returns: Nothing.</p>

<p>These functions can be used to specify whether <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> or <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> should be used by default by <strong class="pkg">Digraphs</strong>. If <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span> is not available, then these functions do nothing. Otherwise, by calling <code class="code">DigraphsUseNauty</code> subsequent computations will default to using <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> rather than <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span>, where possible.</p>

<p>You can call these functions at any point in a <strong class="pkg">GAP</strong> session, as many times as you like, it is guaranteed that existing digraphs remain valid, and that comparison of existing digraphs and newly created digraphs via <code class="func">IsIsomorphicDigraph</code> (<a href="chap7_mj.html#X7B4F24B283C9EE28"><span class="RefLink">7.2-14</span></a>), <code class="func">IsIsomorphicDigraph</code> (<a href="chap7_mj.html#X7D4A1FA8868DA930"><span class="RefLink">7.2-15</span></a>), <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X8219FE6C839D9457"><span class="RefLink">7.2-16</span></a>), and <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X7ED93C0F86D9D34F"><span class="RefLink">7.2-17</span></a>) are also valid.</p>

<p>It is also possible to compute the automorphism group of a specific digraph using both <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> and <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> using <code class="func">NautyAutomorphismGroup</code> (<a href="chap7_mj.html#X857758B18144C0CD"><span class="RefLink">7.2-4</span></a>) and <code class="func">BlissAutomorphismGroup</code> (<a href="chap7_mj.html#X8710D68486A0F44B"><span class="RefLink">7.2-3</span></a>), respectively.</p>

<p><a id="X858C32127A190175" name="X858C32127A190175"></a></p>

<h5>7.2-2 AutomorphismGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AutomorphismGroup</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A permutation group.</p>

<p>If <var class="Arg">digraph</var> is a digraph, then this attribute contains the group of automorphisms of <var class="Arg">digraph</var>. An <em>automorphism</em> of <var class="Arg">digraph</var> is an isomorphism from <var class="Arg">digraph</var> to itself. See <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X8219FE6C839D9457"><span class="RefLink">7.2-16</span></a>) for more information about isomorphisms of digraphs.</p>

<p>The form in which the automorphism group is returned depends on whether <var class="Arg">digraph</var> has multiple edges; see <code class="func">IsMultiDigraph</code> (<a href="chap6_mj.html#X7BB84CFC7E8B2B26"><span class="RefLink">6.1-8</span></a>).</p>


<dl>
<dt><strong class="Mark">for a digraph without multiple edges</strong></dt>
<dd><p>If <var class="Arg">digraph</var> has no multiple edges, then the automorphism group is returned as a group of permutations on the vertices of <var class="Arg">digraph</var>.</p>

</dd>
<dt><strong class="Mark">for a multidigraph</strong></dt>
<dd><p>If <var class="Arg">digraph</var> is a multidigraph, then the automorphism group is a group of permutations on the vertices and edges of <var class="Arg">digraph</var>.</p>

<p>For convenience, the group is returned as the direct product <code class="code">G</code> of the group of automorphisms of the vertices of <var class="Arg">digraph</var> with the stabiliser of the vertices in the automorphism group of the edges. These two groups can be accessed using the operation <code class="func">Projection</code> (<a href="../../../doc/ref/chap32_mj.html#X8769E8DA80BC96C1"><span class="RefLink">Reference: Projection for a domain and a positive integer</span></a>), with the second argument being <code class="code">1</code> or <code class="code">2</code>, respectively.</p>

<p>The permutations in the group <code class="code">Projection(G, 1)</code> act on the vertices of <var class="Arg">digraph</var>, and the permutations in the group <code class="code">Projection(G, 2)</code> act on the indices of <code class="code">DigraphEdges(<var class="Arg">digraph</var>)</code>.</p>

</dd>
</dl>
<p>By default, the automorphism group is found using <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. If <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span> is available, then <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan Mckay and Adolfo Piperno can be used instead; see <code class="func">BlissAutomorphismGroup</code> (<a href="chap7_mj.html#X8710D68486A0F44B"><span class="RefLink">7.2-3</span></a>), <code class="func">NautyAutomorphismGroup</code> (<a href="chap7_mj.html#X857758B18144C0CD"><span class="RefLink">7.2-4</span></a>), <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">johnson := DigraphFromGraph6String("E}lw");</span>
&lt;digraph with 6 vertices, 24 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := AutomorphismGroup(johnson);</span>
Group([ (3,4), (2,3)(4,5), (1,2)(5,6) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">cycle := CycleDigraph(9);</span>
&lt;digraph with 9 vertices, 9 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := AutomorphismGroup(cycle);</span>
Group([ (1,2,3,4,5,6,7,8,9) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsCyclic(G) and Size(G) = 9;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := DigraphEdgeUnion(CycleDigraph(3), CycleDigraph(3));</span>
&lt;multidigraph with 3 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := AutomorphismGroup(gr);</span>
Group([ (1,2,3), (8,9), (6,7), (4,5) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Range(Projection(G, 1));</span>
Group([ (1,2,3) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Range(Projection(G, 2));</span>
Group([ (5,6), (3,4), (1,2) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(G);</span>
24
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := Digraph([[2], [3, 3], [3], [2]]);</span>
&lt;multidigraph with 4 vertices, 5 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := AutomorphismGroup(gr);</span>
Group([ (1,2), (3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">P1 := Projection(G, 1); </span>
1st projection of Group([ (1,2), (3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">P2 := Projection(G, 2);</span>
2nd projection of Group([ (1,2), (3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphVertices(gr);</span>
[ 1 .. 4 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Range(P1);</span>
Group([ (1,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphEdges(gr);</span>
[ [ 1, 2 ], [ 2, 3 ], [ 2, 3 ], [ 3, 3 ], [ 4, 2 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Range(P2);</span>
Group([ (2,3) ])</pre></div>

<p><a id="X8710D68486A0F44B" name="X8710D68486A0F44B"></a></p>

<h5>7.2-3 BlissAutomorphismGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; BlissAutomorphismGroup</code>( <var class="Arg">digraph</var>[, <var class="Arg">colours</var>] )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A permutation group.</p>

<p>If <var class="Arg">digraph</var> is a digraph, then this attribute contains the group of automorphisms of <var class="Arg">digraph</var> as calculated using <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski.</p>

<p>The attribute <code class="func">AutomorphismGroup</code> (<a href="chap7_mj.html#X858C32127A190175"><span class="RefLink">7.2-2</span></a>) and operation <code class="func">AutomorphismGroup</code> (<a href="chap7_mj.html#X877732B1783C391B"><span class="RefLink">7.2-5</span></a>) returns the value of either <code class="code">BlissAutomorphismGroup</code> or <code class="func">NautyAutomorphismGroup</code> (<a href="chap7_mj.html#X857758B18144C0CD"><span class="RefLink">7.2-4</span></a>). These groups are, of course, equal but their generating sets may differ.</p>

<p>See also <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">BlissAutomorphismGroup(JohnsonDigraph(5, 2));</span>
Group([ (3,4)(6,7)(8,9), (2,3)(5,6)(9,10), (2,5)(3,6)(4,7), (1,2)(6,8)
(7,9) ])</pre></div>

<p><a id="X857758B18144C0CD" name="X857758B18144C0CD"></a></p>

<h5>7.2-4 NautyAutomorphismGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; NautyAutomorphismGroup</code>( <var class="Arg">digraph</var>[, <var class="Arg">colours</var>] )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A permutation group.</p>

<p>If <var class="Arg">digraph</var> is a digraph, then this attribute contains the group of automorphisms of <var class="Arg">digraph</var> as calculated using <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan Mckay and Adolfo Piperno via <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span>. The attribute <code class="func">AutomorphismGroup</code> (<a href="chap7_mj.html#X858C32127A190175"><span class="RefLink">7.2-2</span></a>) and operation <code class="func">AutomorphismGroup</code> (<a href="chap7_mj.html#X877732B1783C391B"><span class="RefLink">7.2-5</span></a>) returns the value of either <code class="code">NautyAutomorphismGroup</code> or <code class="func">BlissAutomorphismGroup</code> (<a href="chap7_mj.html#X8710D68486A0F44B"><span class="RefLink">7.2-3</span></a>). These groups are, of course, equal but their generating sets may differ.</p>

<p>See also <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">NautyAutomorphismGroup(JohnsonDigraph(5, 2));</span>
Group([ (3,4)(6,7)(8,9), (2,3)(5,6)(9,10), (2,5)(3,6)(4,7), (1,2)(6,8)(7,9) ])</pre></div>

<p><a id="X877732B1783C391B" name="X877732B1783C391B"></a></p>

<h5>7.2-5 AutomorphismGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AutomorphismGroup</code>( <var class="Arg">digraph</var>, <var class="Arg">colours</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A permutation group.</p>

<p>This operation computes the automorphism group of a coloured digraph. A coloured digraph can be specified by its underlying digraph <var class="Arg">digraph</var> and its colouring <var class="Arg">colours</var>. Let <code class="code">n</code> be the number of vertices of <var class="Arg">digraph</var>. The colouring <var class="Arg">colours</var> may have one of the following two forms:</p>


<ul>
<li><p>a list of <code class="code">n</code> integers, where <var class="Arg">colours</var><code class="code">[i]</code> is the colour of vertex <code class="code">i</code>, using the colours <code class="code">[1 .. m]</code> for some <code class="code">m &lt;= n</code>; or</p>

</li>
<li><p>a list of non-empty disjoint lists whose union is <code class="code">DigraphVertices(<var class="Arg">digraph</var>)</code>, such that <var class="Arg">colours</var><code class="code">[i]</code> is the list of all vertices with colour <code class="code">i</code>.</p>

</li>
</ul>
<p>The <em>automorphism group</em> of a coloured digraph <var class="Arg">digraph</var> with colouring <var class="Arg">colours</var> is the group consisting of its automorphisms; an <em>automorphism</em> of <var class="Arg">digraph</var> is an isomorphism of coloured digraphs from <var class="Arg">digraph</var> to itself. This group is equal to the subgroup of <code class="code">AutomorphismGroup(<var class="Arg">digraph</var>)</code> consisting of those automorphisms that preserve the colouring specified by <var class="Arg">colours</var>. See <code class="func">AutomorphismGroup</code> (<a href="chap7_mj.html#X858C32127A190175"><span class="RefLink">7.2-2</span></a>), and see <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X7ED93C0F86D9D34F"><span class="RefLink">7.2-17</span></a>) for more information about isomorphisms of coloured digraphs.</p>

<p>The form in which the automorphism group is returned depends on whether <var class="Arg">digraph</var> has multiple edges; see <code class="func">IsMultiDigraph</code> (<a href="chap6_mj.html#X7BB84CFC7E8B2B26"><span class="RefLink">6.1-8</span></a>).</p>


<dl>
<dt><strong class="Mark">for a digraph without multiple edges</strong></dt>
<dd><p>If <var class="Arg">digraph</var> has no multiple edges, then the automorphism group is returned as a group of permutations on the vertices of <var class="Arg">digraph</var>.</p>

</dd>
<dt><strong class="Mark">for a multidigraph</strong></dt>
<dd><p>If <var class="Arg">digraph</var> is a multidigraph, then the automorphism group is a group of permutations on the vertices and edges of <var class="Arg">digraph</var>.</p>

<p>For convenience, the group is returned as the direct product <code class="code">G</code> of the group of automorphisms of the vertices of <var class="Arg">digraph</var> with the stabiliser of the vertices in the automorphism group of the edges. These two groups can be accessed using the operation <code class="func">Projection</code> (<a href="../../../doc/ref/chap32_mj.html#X8769E8DA80BC96C1"><span class="RefLink">Reference: Projection for a domain and a positive integer</span></a>), with the second argument being <code class="code">1</code> or <code class="code">2</code>, respectively.</p>

<p>The permutations in the group <code class="code">Projection(G, 1)</code> act on the vertices of <var class="Arg">digraph</var>, and the permutations in the group <code class="code">Projection(G, 2)</code> act on the indices of <code class="code">DigraphEdges(<var class="Arg">digraph</var>)</code>.</p>

</dd>
</dl>
<p>By default, the automorphism group is found using <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. If <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span> is available, then <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan Mckay and Adolfo Piperno can be used instead; see <code class="func">BlissAutomorphismGroup</code> (<a href="chap7_mj.html#X8710D68486A0F44B"><span class="RefLink">7.2-3</span></a>), <code class="func">NautyAutomorphismGroup</code> (<a href="chap7_mj.html#X857758B18144C0CD"><span class="RefLink">7.2-4</span></a>), <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">cycle := CycleDigraph(9);</span>
&lt;digraph with 9 vertices, 9 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := AutomorphismGroup(cycle);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsCyclic(G) and Size(G) = 9;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">colours := [[1, 4, 7], [2, 5, 8], [3, 6, 9]];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">H := AutomorphismGroup(cycle, colours);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(H);</span>
3
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">H = AutomorphismGroup(cycle, [1, 2, 3, 1, 2, 3, 1, 2, 3]);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">H = SubgroupByProperty(G, p -&gt; OnTuplesSets(colours, p) = colours);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsTrivial(AutomorphismGroup(cycle, [1, 1, 2, 2, 2, 2, 2, 2, 2]));</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := Digraph([[2], [3, 3], [3], [2], [2]]);</span>
&lt;multidigraph with 5 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := AutomorphismGroup(gr, [1, 1, 2, 3, 1]);</span>
Group([ (1,2), (3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">P1 := Projection(G, 1); </span>
1st projection of Group([ (1,2), (3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">P2 := Projection(G, 2);</span>
2nd projection of Group([ (1,2), (3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphVertices(gr);</span>
[ 1 .. 5 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Range(P1);</span>
Group([ (1,5) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphEdges(gr);</span>
[ [ 1, 2 ], [ 2, 3 ], [ 2, 3 ], [ 3, 3 ], [ 4, 2 ], [ 5, 2 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Range(P2);</span>
Group([ (2,3) ])</pre></div>

<p><a id="X7D676FE67A6684FF" name="X7D676FE67A6684FF"></a></p>

<h5>7.2-6 BlissCanonicalLabelling</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; BlissCanonicalLabelling</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; NautyCanonicalLabelling</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A permutation, or a list of two permutations.</p>

<p>A function <span class="SimpleMath">\(\rho\)</span> that maps a digraph to a digraph is a <em>canonical representative map</em> if the following two conditions hold for all digraphs <span class="SimpleMath">\(G\)</span> and <span class="SimpleMath">\(H\)</span>:</p>


<ul>
<li><p><span class="SimpleMath">\(\rho(G)\)</span> and <span class="SimpleMath">\(G\)</span> are isomorphic as digraphs; and</p>

</li>
<li><p><span class="SimpleMath">\(\rho(G)=\rho(H)\)</span> if and only if <span class="SimpleMath">\(G\)</span> and <span class="SimpleMath">\(H\)</span> are isomorphic as digraphs.</p>

</li>
</ul>
<p>A <em>canonical labelling</em> of a digraph <span class="SimpleMath">\(G\)</span> (under <span class="SimpleMath">\(\rho\)</span>) is an isomorphism of <span class="SimpleMath">\(G\)</span> onto its <em>canonical representative</em>, <span class="SimpleMath">\(\rho(G)\)</span>. See <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X8219FE6C839D9457"><span class="RefLink">7.2-16</span></a>) for more information about isomorphisms of digraphs.</p>

<p><code class="code">BlissCanonicalLabelling</code> returns a canonical labelling of the digraph <var class="Arg">digraph</var> found using <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. <code class="code">NautyCanonicalLabelling</code> returns a canonical labelling of the digraph <var class="Arg">digraph</var> found using <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan McKay and Adolfo Piperno. Note that the canonical labellings returned by <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> and <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> are not usually the same (and may depend of the version used).</p>

<p>The form of the canonical labelling returned by <code class="code">BlissCanonicalLabelling</code> depends on whether <var class="Arg">digraph</var> has multiple edges; see <code class="func">IsMultiDigraph</code> (<a href="chap6_mj.html#X7BB84CFC7E8B2B26"><span class="RefLink">6.1-8</span></a>).</p>


<dl>
<dt><strong class="Mark">for a digraph without multiple edges</strong></dt>
<dd><p>If the digraph <var class="Arg">digraph</var> has no multiple edges, then the canonical labelling of <var class="Arg">digraph</var> is given as a permutation of its vertices. The canonical representative of <var class="Arg">digraph</var> can be created from <var class="Arg">digraph</var> and its canonical labelling <code class="code">p</code> by using the operation <code class="func">OnDigraphs</code> (<a href="chap7_mj.html#X808972017C486F1F"><span class="RefLink">7.1-1</span></a>):</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph, p);</span></pre></div>

</dd>
<dt><strong class="Mark">for a multidigraph</strong></dt>
<dd><p>The canonical labelling of the multidigraph <var class="Arg">digraph</var> is given as a pair <code class="code">P</code> of permutations. The first, <code class="code">P[1]</code>, is a permutation of the vertices of <var class="Arg">digraph</var>. The second, <code class="code">P[2]</code>, is a permutation of the edges of <var class="Arg">digraph</var>; it acts on the indices of the list <code class="code">DigraphEdges(<var class="Arg">digraph</var>)</code>. The canonical representative of <var class="Arg">digraph</var> can be created from <var class="Arg">digraph</var> and its canonical labelling <code class="code">P</code> by using the operation <code class="func">OnMultiDigraphs</code> (<a href="chap7_mj.html#X7AFBA7608498F9CE"><span class="RefLink">7.1-2</span></a>):</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnMultiDigraphs(digraph, P);</span></pre></div>

</dd>
</dl>

<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := DigraphFromDiSparse6String(".ImNS_AiB?qRN");</span>
&lt;digraph with 10 vertices, 8 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">BlissCanonicalLabelling(digraph1);</span>
(1,3,4)(2,10,6,7,9,8)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p := (1, 2, 7, 5)(3, 9)(6, 10, 8);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := OnDigraphs(digraph1, p);</span>
&lt;digraph with 10 vertices, 8 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 = digraph2;</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph1, BlissCanonicalLabelling(digraph1)) =</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">   OnDigraphs(digraph2, BlissCanonicalLabelling(digraph2));</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := DigraphFromDiSparse6String(".ImEk|O@SK?od");</span>
&lt;multidigraph with 10 vertices, 10 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">BlissCanonicalLabelling(gr);</span>
[ (1,9,7,5)(2,10,3), (1,6,9)(2,5,10,4,8)(3,7) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := Digraph([[2], [3, 3], [3], [2], [2]]);</span>
&lt;multidigraph with 5 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">BlissCanonicalLabelling(gr, [1, 2, 2, 1, 3]);</span>
[ (1,2,4), (1,2,6,4,3,5) ]</pre></div>

<p><a id="X87DA265D803DB337" name="X87DA265D803DB337"></a></p>

<h5>7.2-7 BlissCanonicalLabelling</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; BlissCanonicalLabelling</code>( <var class="Arg">digraph</var>, <var class="Arg">colours</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; NautyCanonicalLabelling</code>( <var class="Arg">digraph</var>, <var class="Arg">colours</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A permutation.</p>

<p>A function <span class="SimpleMath">\(\rho\)</span> that maps a coloured digraph to a coloured digraph is a <em>canonical representative map</em> if the following two conditions hold for all coloured digraphs <span class="SimpleMath">\(G\)</span> and <span class="SimpleMath">\(H\)</span>:</p>


<ul>
<li><p><span class="SimpleMath">\(\rho(G)\)</span> and <span class="SimpleMath">\(G\)</span> are isomorphic as coloured digraphs; and</p>

</li>
<li><p><span class="SimpleMath">\(\rho(G)=\rho(H)\)</span> if and only if <span class="SimpleMath">\(G\)</span> and <span class="SimpleMath">\(H\)</span> are isomorphic as coloured digraphs.</p>

</li>
</ul>
<p>A <em>canonical labelling</em> of a coloured digraph <span class="SimpleMath">\(G\)</span> (under <span class="SimpleMath">\(\rho\)</span>) is an isomorphism of <span class="SimpleMath">\(G\)</span> onto its <em>canonical representative</em>, <span class="SimpleMath">\(\rho(G)\)</span>. See <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X7ED93C0F86D9D34F"><span class="RefLink">7.2-17</span></a>) for more information about isomorphisms of coloured digraphs.</p>

<p>A coloured digraph can be specified by its underlying digraph <var class="Arg">digraph</var> and its colouring <var class="Arg">colours</var>. Let <code class="code">n</code> be the number of vertices of <var class="Arg">digraph</var>. The colouring <var class="Arg">colours</var> may have one of the following two forms:</p>


<ul>
<li><p>a list of <code class="code">n</code> integers, where <var class="Arg">colours</var><code class="code">[i]</code> is the colour of vertex <code class="code">i</code>, using the colours <code class="code">[1 .. m]</code> for some <code class="code">m &lt;= n</code>; or</p>

</li>
<li><p>a list of non-empty disjoint lists whose union is <code class="code">DigraphVertices(<var class="Arg">digraph</var>)</code>, such that <var class="Arg">colours</var><code class="code">[i]</code> is the list of all vertices with colour <code class="code">i</code>.</p>

</li>
</ul>
<p>If <var class="Arg">digraph</var> and <var class="Arg">colours</var> together form a coloured digraph, <code class="code">BlissCanonicalLabelling</code> returns a canonical labelling of the digraph <var class="Arg">digraph</var> found using <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. Similarly, <code class="code">NautyCanonicalLabelling</code> returns a canonical labelling of the digraph <var class="Arg">digraph</var> found using <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan McKay and Adolfo Piperno. Note that the canonical labellings returned by <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> and <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> are not usually the same (and may depend of the version used).</p>

<p>The form of the canonical labelling returned by <code class="code">BlissCanonicalLabelling</code> depends on whether <var class="Arg">digraph</var> has multiple edges; see <code class="func">IsMultiDigraph</code> (<a href="chap6_mj.html#X7BB84CFC7E8B2B26"><span class="RefLink">6.1-8</span></a>).</p>


<dl>
<dt><strong class="Mark">for a digraph without multiple edges</strong></dt>
<dd><p>If the digraph <var class="Arg">digraph</var> has no multiple edges, then the canonical labelling of <var class="Arg">digraph</var> is given as a permutation of its vertices. The canonical representative of <var class="Arg">digraph</var> can be created from <var class="Arg">digraph</var> and its canonical labelling <code class="code">p</code> by using the operation <code class="func">OnDigraphs</code> (<a href="chap7_mj.html#X808972017C486F1F"><span class="RefLink">7.1-1</span></a>):</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph, p);</span></pre></div>

</dd>
<dt><strong class="Mark">for a multidigraph</strong></dt>
<dd><p>The canonical labelling of the multidigraph <var class="Arg">digraph</var> is given as a pair <code class="code">P</code> of permutations. The first, <code class="code">P[1]</code>, is a permutation of the vertices of <var class="Arg">digraph</var>. The second, <code class="code">P[2]</code>, is a permutation of the edges of <var class="Arg">digraph</var>; it acts on the indices of the list <code class="code">DigraphEdges(<var class="Arg">digraph</var>)</code>. The canonical representative of <var class="Arg">digraph</var> can be created from <var class="Arg">digraph</var> and its canonical labelling <code class="code">P</code> by using the operation <code class="func">OnMultiDigraphs</code> (<a href="chap7_mj.html#X7AFBA7608498F9CE"><span class="RefLink">7.1-2</span></a>):</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnMultiDigraphs(digraph, P);</span></pre></div>

</dd>
</dl>
<p>In either case, the colouring of the canonical representative can easily be constructed. A vertex <code class="code">v</code> (in <var class="Arg">digraph</var>) has colour <code class="code">i</code> if and only if the vertex <code class="code">v ^ p</code> (in the canonical representative) has colour <code class="code">i</code>, where <code class="code">p</code> is the permutation of the canonical labelling that acts on the vertices of <var class="Arg">digraph</var>. In particular, if <var class="Arg">colours</var> has the first form that is described above, then the colouring of the canonical representative is given by:</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(DigraphVertices(digraph), i -&gt; colours[i / p]);</span></pre></div>

<p>On the other hand, if <var class="Arg">colours</var> has the second form above, then the canonical representative has colouring:</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnTuplesSets(colours, p);</span></pre></div>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := DigraphFromDiSparse6String(".ImNS_AiB?qRN");</span>
&lt;digraph with 10 vertices, 8 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">colours := [[1, 2, 8, 9, 10], [3, 4, 5, 6, 7]];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p := BlissCanonicalLabelling(digraph, colours);</span>
(2,3,7,10)(4,6,9,5,8)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph, p);</span>
&lt;digraph with 10 vertices, 8 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnTuplesSets(colours, p);</span>
[ [ 1, 2, 3, 4, 5 ], [ 6, 7, 8, 9, 10 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">colours := [1, 1, 1, 1, 2, 3, 1, 3, 2, 1];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p := BlissCanonicalLabelling(digraph, colours);</span>
(2,3,4,6,10,5,8,9,7)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph, p);</span>
&lt;digraph with 10 vertices, 8 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(DigraphVertices(digraph), i -&gt; colours[i / p]);</span>
[ 1, 1, 1, 1, 1, 1, 2, 2, 3, 3 ]</pre></div>

<p><a id="X877B1D377EC197D7" name="X877B1D377EC197D7"></a></p>

<h5>7.2-8 BlissCanonicalDigraph</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; BlissCanonicalDigraph</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; NautyCanonicalDigraph</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A digraph.</p>

<p>The attribute <code class="code">BlissCanonicalLabelling</code> returns the canonical representative found by applying <code class="func">BlissCanonicalLabelling</code> (<a href="chap7_mj.html#X7D676FE67A6684FF"><span class="RefLink">7.2-6</span></a>). The digraph returned is canonical in the sense that</p>


<ul>
<li><p><code class="code">BlissCanonicalDigraph(<var class="Arg">digraph</var>)</code> and <var class="Arg">digraph</var> are isomorphic as digraphs; and</p>

</li>
<li><p>If <code class="code">gr</code> is any digraph then <code class="code">BlissCanonicalDigraph(gr)</code> and <code class="code">BlissCanonicalDigraph(<var class="Arg">digraph</var>)</code> are equal if and only if <code class="code">gr</code> and <var class="Arg">digraph</var> are isomorphic as digraphs.</p>

</li>
</ul>
<p>Analogously, the attribute <code class="code">NautyCanonicalLabelling</code> returns the canonical representative found by applying <code class="func">NautyCanonicalLabelling</code> (<a href="chap7_mj.html#X7D676FE67A6684FF"><span class="RefLink">7.2-6</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := Digraph([[1], [2, 3], [3], [1, 2, 3]]);</span>
&lt;digraph with 4 vertices, 7 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">canon := BlissCanonicalDigraph(digraph);</span>
&lt;digraph with 4 vertices, 7 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OutNeighbours(canon);</span>
[ [ 1 ], [ 2, 4 ], [ 1, 2, 4 ], [ 4 ] ]
</pre></div>

<p><a id="X803ACEDA7BBAC5B3" name="X803ACEDA7BBAC5B3"></a></p>

<h5>7.2-9 DigraphGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphGroup</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A permutation group.</p>

<p>If <var class="Arg">digraph</var> was created knowing a subgroup of its automorphism group, then this group is stored in the attribute <code class="code">DigraphGroup</code>. If <var class="Arg">digraph</var> is not created knowing a subgroup of its automorphism group, then <code class="code">DigraphGroup</code> returns the entire automorphism group of <var class="Arg">digraph</var>.</p>

<p>Note that certain other constructor operations such as <code class="func">CayleyDigraph</code> (<a href="chap3_mj.html#X7FCADADC7EC28478"><span class="RefLink">3.1-10</span></a>), <code class="func">BipartiteDoubleDigraph</code> (<a href="chap3_mj.html#X7C6E6CB284982C7A"><span class="RefLink">3.3-31</span></a>), and <code class="func">DoubleDigraph</code> (<a href="chap3_mj.html#X7FB8B48C87C0ED16"><span class="RefLink">3.3-30</span></a>), may not require a group as one of the arguments, but use the standard constructor method using a group, and hence set the <code class="code">DigraphGroup</code> attribute for the resulting digraph.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">n := 4;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">adj := function(x, y)</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">     return (((x - y) mod n) = 1) or (((x - y) mod n) = n - 1);</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">   end;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">group := CyclicGroup(IsPermGroup, n);</span>
Group([ (1,2,3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := Digraph(group, [1 .. n], \^, adj);</span>
&lt;digraph with 4 vertices, 8 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HasDigraphGroup(digraph);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphGroup(digraph);</span>
Group([ (1,2,3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AutomorphismGroup(digraph);</span>
Group([ (2,4), (1,2)(3,4) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ddigraph := DoubleDigraph(digraph);</span>
&lt;digraph with 8 vertices, 32 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HasDigraphGroup(ddigraph);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphGroup(ddigraph);</span>
Group([ (1,2,3,4)(5,6,7,8), (1,5)(2,6)(3,7)(4,8) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AutomorphismGroup(ddigraph) =</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">Group([(6, 8), (5, 7), (4, 6), (3, 5), (2, 4), </span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">       (1, 2)(3, 4)(5, 6)(7, 8)]);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := Digraph([[2, 3], [], []]);</span>
&lt;digraph with 3 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HasDigraphGroup(digraph);</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HasAutomorphismGroup(digraph);</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphGroup(digraph);</span>
Group([ (2,3) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HasAutomorphismGroup(digraph);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">group := DihedralGroup(8);</span>
&lt;pc group of size 8 with 3 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := CayleyDigraph(group);</span>
&lt;digraph with 8 vertices, 24 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HasDigraphGroup(digraph);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphGroup(digraph);</span>
Group([ (1,2)(3,8)(4,6)(5,7), (1,3,4,7)(2,5,6,8), (1,4)(2,6)(3,7)
(5,8) ])
</pre></div>

<p><a id="X8096C5287E459279" name="X8096C5287E459279"></a></p>

<h5>7.2-10 DigraphOrbits</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphOrbits</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A list of lists of integers.</p>

<p><code class="code">DigraphOrbits</code> returns the orbits of the action of the <code class="func">DigraphGroup</code> (<a href="chap7_mj.html#X803ACEDA7BBAC5B3"><span class="RefLink">7.2-9</span></a>) on the set of vertices of <var class="Arg">digraph</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := Group([(2, 3)(7, 8, 9), (1, 2, 3)(4, 5, 6)(8, 9)]);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := EdgeOrbitsDigraph(G, [1, 2]);</span>
&lt;digraph with 9 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphOrbits(gr);</span>
[ [ 1, 2, 3 ], [ 4, 5, 6 ], [ 7, 8, 9 ] ]
</pre></div>

<p><a id="X8386028782F2D3FF" name="X8386028782F2D3FF"></a></p>

<h5>7.2-11 DigraphOrbitReps</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphOrbitReps</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A list of integers.</p>

<p><code class="code">DigraphOrbitReps</code> returns a list of orbit representatives of the action of the <code class="func">DigraphGroup</code> (<a href="chap7_mj.html#X803ACEDA7BBAC5B3"><span class="RefLink">7.2-9</span></a>) on the set of vertices of <var class="Arg">digraph</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := CayleyDigraph(AlternatingGroup(4));</span>
&lt;digraph with 12 vertices, 24 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphOrbitReps(digraph);</span>
[ 1 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := DigraphFromDigraph6String("+I?OGg????A?Ci_o_@?");</span>
&lt;digraph with 10 vertices, 14 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphOrbitReps(digraph);</span>
[ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]
</pre></div>

<p><a id="X8657604E87A25E5F" name="X8657604E87A25E5F"></a></p>

<h5>7.2-12 DigraphSchreierVector</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphSchreierVector</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A list of integers.</p>

<p><code class="code">DigraphSchreierVector</code> returns the so-called <em>Schreier vector</em> of the action of the <code class="func">DigraphGroup</code> (<a href="chap7_mj.html#X803ACEDA7BBAC5B3"><span class="RefLink">7.2-9</span></a>) on the set of vertices of <var class="Arg">digraph</var>. The Schreier vector is a list <code class="code">sch</code> of integers with length <code class="code">DigraphNrVertices(<var class="Arg">digraph</var>)</code> where:</p>


<dl>
<dt><strong class="Mark"><code class="code">sch[i] &lt; 0:</code></strong></dt>
<dd><p>implies that <code class="code">i</code> is an orbit representative and <code class="code">DigraphOrbitReps(<var class="Arg">digraph</var>)[-sch[i]] = i</code>.</p>

</dd>
<dt><strong class="Mark"><code class="code">sch[i] &gt; 0:</code></strong></dt>
<dd><p>implies that <code class="code">i / gens[sch[i]]</code> is one step closer to the root (or representative) of the tree, where <code class="code">gens</code> is the generators of <code class="code">DigraphGroup(<var class="Arg">digraph</var>)</code>.</p>

</dd>
</dl>

<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := CayleyDigraph(AlternatingGroup(4));</span>
&lt;digraph with 12 vertices, 24 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">sch := DigraphSchreierVector(digraph);</span>
[ -1, 2, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphOrbitReps(digraph);</span>
[ 1 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gens := GeneratorsOfGroup(DigraphGroup(digraph));</span>
[ (1,5,7)(2,4,8)(3,6,9)(10,11,12), (1,2,3)(4,7,10)(5,9,11)(6,8,12) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">10 / gens[sch[10]];</span>
7
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">7 / gens[sch[7]];</span>
5
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">5 / gens[sch[5]];</span>
1</pre></div>

<p><a id="X78913684795FB256" name="X78913684795FB256"></a></p>

<h5>7.2-13 DigraphStabilizer</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphStabilizer</code>( <var class="Arg">digraph</var>, <var class="Arg">v</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A permutation group.</p>

<p><code class="code">DigraphStabilizer</code> returns the stabilizer of the vertex <var class="Arg">v</var> under of the action of the <code class="func">DigraphGroup</code> (<a href="chap7_mj.html#X803ACEDA7BBAC5B3"><span class="RefLink">7.2-9</span></a>) on the set of vertices of <var class="Arg">digraph</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := DigraphFromDigraph6String("+GUIQQWWXHHPg");</span>
&lt;digraph with 8 vertices, 24 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphStabilizer(digraph, 8);</span>
Group(())
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphStabilizer(digraph, 2);</span>
Group(())
</pre></div>

<p><a id="X7B4F24B283C9EE28" name="X7B4F24B283C9EE28"></a></p>

<h5>7.2-14 IsIsomorphicDigraph</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsIsomorphicDigraph</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: <code class="keyw">true</code> or <code class="keyw">false</code>.</p>

<p>This operation returns <code class="keyw">true</code> if there exists an isomorphism from the digraph <var class="Arg">digraph1</var> to the digraph <var class="Arg">digraph2</var>. See <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X8219FE6C839D9457"><span class="RefLink">7.2-16</span></a>) for more information about isomorphisms of digraphs.</p>

<p>By default, an isomorphism is found using the canonical labellings of the digraphs obtained from <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. If <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span> is available, then <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan Mckay and Adolfo Piperno can be used instead; see <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := CycleDigraph(4);</span>
&lt;digraph with 4 vertices, 4 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := CycleDigraph(5);</span>
&lt;digraph with 5 vertices, 5 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2);</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := DigraphReverse(digraph1);</span>
&lt;digraph with 4 vertices, 4 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := DigraphFromDiSparse6String(".IiGdqrHiogeaF");</span>
&lt;multidigraph with 10 vertices, 10 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := DigraphFromDiSparse6String(".IiK`K@FFSouF_|^");</span>
&lt;multidigraph with 10 vertices, 10 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2);</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := Digraph([[3], [], []]);</span>
&lt;digraph with 3 vertices, 1 edge&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := Digraph([[], [], [2]]);</span>
&lt;digraph with 3 vertices, 1 edge&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2);</span>
true</pre></div>

<p><a id="X7D4A1FA8868DA930" name="X7D4A1FA8868DA930"></a></p>

<h5>7.2-15 IsIsomorphicDigraph</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsIsomorphicDigraph</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var>, <var class="Arg">colours1</var>, <var class="Arg">colours2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: <code class="keyw">true</code> or <code class="keyw">false</code>.</p>

<p>This operation tests for isomorphism of coloured digraphs. A coloured digraph can be specified by its underlying digraph <var class="Arg">digraph1</var> and its colouring <var class="Arg">colours1</var>. Let <code class="code">n</code> be the number of vertices of <var class="Arg">digraph1</var>. The colouring <var class="Arg">colours1</var> may have one of the following two forms:</p>


<ul>
<li><p>a list of <code class="code">n</code> integers, where <var class="Arg">colours</var><code class="code">[i]</code> is the colour of vertex <code class="code">i</code>, using the colours <code class="code">[1 .. m]</code> for some <code class="code">m &lt;= n</code>; or</p>

</li>
<li><p>a list of non-empty disjoint lists whose union is <code class="code">DigraphVertices(<var class="Arg">digraph</var>)</code>, such that <var class="Arg">colours</var><code class="code">[i]</code> is the list of all vertices with colour <code class="code">i</code>.</p>

</li>
</ul>
<p>If <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var> are digraphs without multiple edges, and <var class="Arg">colours1</var> and <var class="Arg">colours2</var> are colourings of <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var>, respectively, then this operation returns <code class="keyw">true</code> if there exists an isomorphism between these two coloured digraphs. See <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X7ED93C0F86D9D34F"><span class="RefLink">7.2-17</span></a>) for more information about isomorphisms of coloured digraphs.</p>

<p>By default, an isomorphism is found using the canonical labellings of the digraphs obtained from <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. If <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span> is available, then <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan Mckay and Adolfo Piperno can be used instead; see <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := ChainDigraph(4);</span>
&lt;digraph with 4 vertices, 3 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := ChainDigraph(3);</span>
&lt;digraph with 3 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> [[1, 4], [2, 3]], [[1, 2], [3]]);</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := DigraphReverse(digraph1);</span>
&lt;digraph with 4 vertices, 3 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> [1, 1, 1, 1], [1, 1, 1, 1]);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> [1, 2, 2, 1], [1, 2, 2, 1]);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> [1, 1, 2, 2], [1, 1, 2, 2]);</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := Digraph([[2, 1, 2], [1, 2, 1]]);</span>
&lt;multidigraph with 2 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph1, [2, 1], [1, 2]);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsIsomorphicDigraph(digraph1, digraph1, [1, 1], [1, 2]);</span>
false</pre></div>

<p><a id="X8219FE6C839D9457" name="X8219FE6C839D9457"></a></p>

<h5>7.2-16 IsomorphismDigraphs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsomorphismDigraphs</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A permutation, or a pair of permutations, or <code class="keyw">fail</code>.</p>

<p>This operation returns an isomorphism between the digraphs <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var> if one exists, else this operation returns <code class="keyw">fail</code>.</p>


<dl>
<dt><strong class="Mark">for digraphs without multiple edges</strong></dt>
<dd><p>An <em>isomorphism</em> from a digraph <var class="Arg">digraph1</var> to a digraph <var class="Arg">digraph2</var> is a bijection <code class="code">p</code> from the vertices of <var class="Arg">digraph1</var> to the vertices of <var class="Arg">digraph2</var> with the following property: for all vertices <code class="code">i</code> and <code class="code">j</code> of <var class="Arg">digraph1</var>, <code class="code">[i, j]</code> is an edge of <var class="Arg">digraph1</var> if and only if <code class="code">[i ^ p, j ^ p]</code> is an edge of <var class="Arg">digraph2</var>.</p>

<p>If there exists such an isomorphism, then this operation returns one. The form of this isomorphism is a permutation <code class="code">p</code> of the vertices of <var class="Arg">digraph1</var> such that</p>

<p><code class="code">OnDigraphs(<var class="Arg">digraph1</var>, p) = digraph2</code>.</p>

</dd>
<dt><strong class="Mark">for multidigraphs</strong></dt>
<dd><p>An <em>isomorphism</em> from a multidigraph <var class="Arg">digraph1</var> to a multidigraph <var class="Arg">digraph2</var> is a bijection <code class="code">P[1]</code> from the vertices of <var class="Arg">digraph1</var> to the vertices of <var class="Arg">digraph2</var> and a bijection <code class="code">P[2]</code> from the indices of edges of <var class="Arg">digraph1</var> to the indices of edges of <var class="Arg">digraph2</var> with the following property: <code class="code">[i, j]</code> is the <code class="code">k</code>th edge of <var class="Arg">digraph1</var> if and only if <code class="code">[i ^ P[1], j ^ P[1]]</code> is the <code class="code">(k ^ P[2])</code>th edge of <var class="Arg">digraph2</var>.</p>

<p>If there exists such an isomorphism, then this operation returns one. The form of this isomorphism is a pair of permutations <code class="code">P</code> - where the first is a permutation of the vertices of <var class="Arg">digraph1</var> and the second is a permutation of the indices of <code class="code">DigraphEdges(<var class="Arg">digraph1</var>)</code> - such that</p>

<p><code class="code">OnMultiDigraphs(<var class="Arg">digraph1</var>, P) = <var class="Arg">digraph2</var></code>.</p>

</dd>
</dl>
<p>By default, an isomorphism is found using the canonical labellings of the digraphs obtained from <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. If <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span> is available, then <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan Mckay and Adolfo Piperno can be used instead; see <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := CycleDigraph(4);</span>
&lt;digraph with 4 vertices, 4 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := CycleDigraph(5);</span>
&lt;digraph with 5 vertices, 5 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsomorphismDigraphs(digraph1, digraph2);</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := CompleteBipartiteDigraph(10, 5);</span>
&lt;digraph with 15 vertices, 100 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := CompleteBipartiteDigraph(5, 10);</span>
&lt;digraph with 15 vertices, 100 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p := IsomorphismDigraphs(digraph1, digraph2);</span>
(1,6,11)(2,7,12)(3,8,13)(4,9,14)(5,10,15)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph1, p) = digraph2;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := DigraphFromDiSparse6String(".ImNS_?DSE@ce[~");</span>
&lt;multidigraph with 10 vertices, 10 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := DigraphFromDiSparse6String(".IkOlQefi_kgOf");</span>
&lt;multidigraph with 10 vertices, 10 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsomorphismDigraphs(digraph1, digraph2);</span>
[ (1,9,5,3,10,6,4,7,2), (1,8,6,3,7)(2,9,4,10,5) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := DigraphByEdges([[7, 10], [7, 10]], 10);</span>
&lt;multidigraph with 10 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := DigraphByEdges([[2, 3], [2, 3]], 10);</span>
&lt;multidigraph with 10 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsomorphismDigraphs(digraph1, digraph2);</span>
[ (2,4,6,8,9,10,3,5,7), () ]</pre></div>

<p><a id="X7ED93C0F86D9D34F" name="X7ED93C0F86D9D34F"></a></p>

<h5>7.2-17 IsomorphismDigraphs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsomorphismDigraphs</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var>, <var class="Arg">colours1</var>, <var class="Arg">colours2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A permutation, or <code class="keyw">fail</code>.</p>

<p>This operation searches for an isomorphism between coloured digraphs. A coloured digraph can be specified by its underlying digraph <var class="Arg">digraph1</var> and its colouring <var class="Arg">colours1</var>. Let <code class="code">n</code> be the number of vertices of <var class="Arg">digraph1</var>. The colouring <var class="Arg">colours1</var> may have one of the following two forms:</p>


<ul>
<li><p>a list of <code class="code">n</code> integers, where <var class="Arg">colours</var><code class="code">[i]</code> is the colour of vertex <code class="code">i</code>, using the colours <code class="code">[1 .. m]</code> for some <code class="code">m &lt;= n</code>; or</p>

</li>
<li><p>a list of non-empty disjoint lists whose union is <code class="code">DigraphVertices(<var class="Arg">digraph</var>)</code>, such that <var class="Arg">colours</var><code class="code">[i]</code> is the list of all vertices with colour <code class="code">i</code>.</p>

</li>
</ul>
<p>An <em>isomorphism</em> between coloured digraphs is an isomorphism between the underlying digraphs that preserves the colourings. See <code class="func">IsomorphismDigraphs</code> (<a href="chap7_mj.html#X8219FE6C839D9457"><span class="RefLink">7.2-16</span></a>) for more information about isomorphisms of digraphs. More precisely, let <code class="code">f</code> be an isomorphism of digraphs from the digraph <var class="Arg">digraph1</var> (with colouring <var class="Arg">colours1</var>) to the digraph <var class="Arg">digraph2</var> (with colouring <var class="Arg">colours2</var>), and let <code class="code">p</code> be the permutation of the vertices of <var class="Arg">digraph1</var> that corresponds to <code class="code">f</code>. Then <code class="code">f</code> preserves the colourings of <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var>  and hence is an isomorphism of coloured digraphs  if <code class="code"><var class="Arg">colours1</var>[i] = <var class="Arg">colours2</var>[i ^ p]</code> for all vertices <code class="code">i</code> in <var class="Arg">digraph1</var>.</p>

<p>This operation returns such an isomorphism if one exists, else it returns <code class="keyw">fail</code>.</p>

<p>By default, an isomorphism is found using the canonical labellings of the digraphs obtained from <span class="URL"><a href="http://www.tcs.tkk.fi/Software/bliss/">bliss</a></span> by Tommi Junttila and Petteri Kaski. If <span class="URL"><a href="https://github.com/sebasguts/NautyTracesInterface">NautyTracesInterface</a></span> is available, then <span class="URL"><a href="http://pallini.di.uniroma1.it/">nauty</a></span> by Brendan Mckay and Adolfo Piperno can be used instead; see <code class="func">DigraphsUseBliss</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>), and <code class="func">DigraphsUseNauty</code> (<a href="chap7_mj.html#X83E593F3855B122E"><span class="RefLink">7.2-1</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := ChainDigraph(4);</span>
&lt;digraph with 4 vertices, 3 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := ChainDigraph(3);</span>
&lt;digraph with 3 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsomorphismDigraphs(digraph1, digraph2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> [[1, 4], [2, 3]], [[1, 2], [3]]);</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := DigraphReverse(digraph1);</span>
&lt;digraph with 4 vertices, 3 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">colours1 := [1, 1, 1, 1];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">colours2 := [1, 1, 1, 1];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p := IsomorphismDigraphs(digraph1, digraph2, colours1, colours2);</span>
(1,4)(2,3)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph1, p) = digraph2;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(DigraphVertices(digraph1), i -&gt; colours1[i ^ p]) = colours2;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">colours1 := [1, 1, 2, 2];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">colours2 := [2, 2, 1, 1];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p := IsomorphismDigraphs(digraph1, digraph2, colours1, colours2);</span>
(1,4)(2,3)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">OnDigraphs(digraph1, p) = digraph2;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(DigraphVertices(digraph1), i -&gt; colours1[i ^ p]) = colours2;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsomorphismDigraphs(digraph1, digraph2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> [1, 1, 2, 2], [1, 1, 2, 2]);</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph1 := Digraph([[2, 2], [2], [1]]);</span>
&lt;multidigraph with 3 vertices, 4 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph2 := Digraph([[1], [1, 1], [2]]);</span>
&lt;multidigraph with 3 vertices, 4 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsomorphismDigraphs(digraph1, digraph2, [1, 2, 2], [2, 1, 2]);</span>
[ (1,2), (1,2,3) ]</pre></div>

<p><a id="X7E1C806D81DFE15E" name="X7E1C806D81DFE15E"></a></p>

<h5>7.2-18 RepresentativeOutNeighbours</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RepresentativeOutNeighbours</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: An immutable list of immutable lists.</p>

<p>This function returns the list <code class="code">out</code> of <em>out-neighbours</em> of each representative of the orbits of the action of <code class="func">DigraphGroup</code> (<a href="chap7_mj.html#X803ACEDA7BBAC5B3"><span class="RefLink">7.2-9</span></a>) on the vertex set of the digraph <var class="Arg">digraph</var>.</p>

<p>More specifically, if <code class="code">reps</code> is the list of orbit representatives, then a vertex <code class="code">j</code> appears in <code class="code">out[i]</code> each time there exists an edge with source <code class="code">reps[i]</code> and range <code class="code">j</code> in <var class="Arg">digraph</var>.</p>

<p>If <code class="func">DigraphGroup</code> (<a href="chap7_mj.html#X803ACEDA7BBAC5B3"><span class="RefLink">7.2-9</span></a>) is trivial, then <code class="func">OutNeighbours</code> (<a href="chap5_mj.html#X7E9880767AE68E00"><span class="RefLink">5.2-5</span></a>) is returned.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := Digraph([</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> [2, 1, 3, 4, 5], [3, 5], [2], [1, 2, 3, 5], [1, 2, 3, 4]]);</span>
&lt;digraph with 5 vertices, 16 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphGroup(digraph);</span>
Group(())
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">RepresentativeOutNeighbours(digraph);</span>
[ [ 2, 1, 3, 4, 5 ], [ 3, 5 ], [ 2 ], [ 1, 2, 3, 5 ], [ 1, 2, 3, 4 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">digraph := DigraphFromDigraph6String("+GUIQQWWXHHPg");</span>
&lt;digraph with 8 vertices, 24 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphGroup(digraph);</span>
Group([ (1,2)(3,4)(5,6)(7,8), (1,3,2,4)(5,7,6,8), (1,5)(2,6)(3,8)
(4,7) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">RepresentativeOutNeighbours(digraph);</span>
[ [ 2, 3, 5 ] ]</pre></div>

<p><a id="X7E1A02FE8384C03C" name="X7E1A02FE8384C03C"></a></p>

<h4>7.3 <span class="Heading">Homomorphisms of digraphs</span></h4>

<p>The following methods exist to find homomorphisms between digraphs. If an argument to one of these methods is a digraph with multiple edges, then the multiplicity of edges will be ignored in order to perform the calculation; the digraph will be treated as if it has no multiple edges.</p>

<p><a id="X79ABF0E783FD67C7" name="X79ABF0E783FD67C7"></a></p>

<h5>7.3-1 HomomorphismDigraphsFinder</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; HomomorphismDigraphsFinder</code>( <var class="Arg">gr1</var>, <var class="Arg">gr2</var>, <var class="Arg">hook</var>, <var class="Arg">user_param</var>, <var class="Arg">limit</var>, <var class="Arg">hint</var>, <var class="Arg">injective</var>, <var class="Arg">image</var>, <var class="Arg">map</var> )</td><td class="tdright">( function )</td></tr></table></div>
<p>Returns: The argument <var class="Arg">user_param</var>.</p>

<p>This function finds homomorphisms from the graph <var class="Arg">gr1</var> to the graph <var class="Arg">gr2</var> subject to the conditions imposed by the other arguments as described below.</p>

<p>If <code class="code">f</code> and <code class="code">g</code> are homomorphisms found by <code class="code">HomomorphismGraphsFinder</code>, then <code class="code">f</code> cannot be obtained from <code class="code">g</code> by right multiplying by an automorphism of <var class="Arg">gr2</var>.</p>


<dl>
<dt><strong class="Mark"><var class="Arg">hook</var></strong></dt>
<dd><p>This argument should be a function or <code class="keyw">fail</code>.</p>

<p>If <var class="Arg">hook</var> is a function, then it should have two arguments <var class="Arg">user_param</var> (see below) and a transformation <code class="code">t</code>. The function <code class="code"><var class="Arg">hook</var>(<var class="Arg">user_param</var>, t)</code> is called every time a new homomorphism <code class="code">t</code> is found by <code class="code">HomomorphismGraphsFinder</code>.</p>

<p>If <var class="Arg">hook</var> is <code class="keyw">fail</code>, then a default function is used which simply adds every new homomorphism found by <code class="code">HomomorphismGraphsFinder</code> to <var class="Arg">user_param</var>, which must be a list in this case.</p>

</dd>
<dt><strong class="Mark"><var class="Arg">user_param</var></strong></dt>
<dd><p>If <var class="Arg">hook</var> is a function, then <var class="Arg">user_param</var> can be any <strong class="pkg">GAP</strong> object. The object <var class="Arg">user_param</var> is used as the first argument for the function <var class="Arg">hook</var>. For example, <var class="Arg">user_param</var> might be a transformation semigroup, and <code class="code"><var class="Arg">hook</var>(<var class="Arg">user_param</var>, t)</code> might set <var class="Arg">user_param</var> to be the closure of <var class="Arg">user_param</var> and <code class="code">t</code>.</p>

<p>If the value of <var class="Arg">hook</var> is <code class="keyw">fail</code>, then the value of <var class="Arg">user_param</var> must be a list.</p>

</dd>
<dt><strong class="Mark"><var class="Arg">limit</var></strong></dt>
<dd><p>This argument should be a positive integer or <code class="keyw">infinity</code>. <code class="code">HomomorphismGraphsFinder</code> will return after it has found <var class="Arg">limit</var> homomorphisms or the search is complete.</p>

</dd>
<dt><strong class="Mark"><var class="Arg">hint</var></strong></dt>
<dd><p>This argument should be a positive integer or <code class="keyw">fail</code>.</p>

<p>If <var class="Arg">hint</var> is a positive integer, then only homorphisms of rank <var class="Arg">hint</var> are found.</p>

<p>If <var class="Arg">hint</var> is <code class="keyw">fail</code>, then no restriction is put on the rank of homomorphisms found.</p>

</dd>
<dt><strong class="Mark"><var class="Arg">injective</var></strong></dt>
<dd><p>This argument should be <code class="keyw">true</code> or <code class="keyw">false</code>. If it is <code class="keyw">true</code>, then only injective homomorphisms are found, and if it is <code class="keyw">false</code> there are no restrictions imposed by this argument.</p>

</dd>
<dt><strong class="Mark"><var class="Arg">image</var></strong></dt>
<dd><p>This argument should be a subset of the vertices of the graph <var class="Arg">gr2</var>. <code class="code">HomomorphismGraphsFinder</code> only finds homomorphisms from <var class="Arg">gr1</var> to the subgraph of <var class="Arg">gr2</var> induced by the vertices <var class="Arg">image</var>.</p>

</dd>
<dt><strong class="Mark"><var class="Arg">map</var></strong></dt>
<dd><p>This argument should be a partial map from <var class="Arg">gr1</var> to <var class="Arg">gr2</var>, that is, a (not necessarily dense) list of vertices of the graph <var class="Arg">gr2</var> of length no greater than the number vertices in the graph <var class="Arg">gr1</var>. <code class="code">HomomorphismGraphsFinder</code> only finds homomorphisms extending <var class="Arg">map</var> (if any).</p>

</dd>
</dl>

<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := ChainDigraph(10);</span>
&lt;digraph with 10 vertices, 9 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := DigraphSymmetricClosure(gr);</span>
&lt;digraph with 10 vertices, 18 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HomomorphismDigraphsFinder(gr, gr, fail, [], infinity, 2, false,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[3, 4], [], fail, fail);</span>
[ Transformation( [ 3, 4, 3, 4, 3, 4, 3, 4, 3, 4 ] ), 
  Transformation( [ 4, 3, 4, 3, 4, 3, 4, 3, 4, 3 ] ) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := CompleteDigraph(6);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HomomorphismDigraphsFinder(gr, gr2, fail, [], 1, fail, false,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[1 .. 6], [1, 2, 1], fail, fail);</span>
[ Transformation( [ 1, 2, 1, 3, 4, 5, 6, 1, 2, 1 ] ) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">func := function(user_param, t)</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">Add(user_param, t * user_param[1]);</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">end;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HomomorphismDigraphsFinder(gr, gr2, func, [Transformation([2, 2])],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">3, fail, false, [1 .. 6], [1, 2, 1], fail, fail);</span>
[ Transformation( [ 2, 2 ] ), 
  Transformation( [ 2, 2, 2, 3, 4, 5, 6, 2, 2, 2 ] ), 
  Transformation( [ 2, 2, 2, 3, 4, 5, 6, 2, 2, 3 ] ), 
  Transformation( [ 2, 2, 2, 3, 4, 5, 6, 2, 2, 4 ] ) ]</pre></div>

<p><a id="X85E9B019877AD7FE" name="X85E9B019877AD7FE"></a></p>

<h5>7.3-2 DigraphHomomorphism</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphHomomorphism</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A transformation, or <code class="keyw">fail</code>.</p>

<p>A homomorphism from <var class="Arg">digraph1</var> to <var class="Arg">digraph2</var> is a mapping from the vertex set of <var class="Arg">digraph1</var> to a subset of the vertices of <var class="Arg">digraph2</var>, such that every pair of vertices <code class="code">[i,j]</code> which has an edge <code class="code">i-&gt;j</code> is mapped to a pair of vertices <code class="code">[a,b]</code> which has an edge <code class="code">a-&gt;b</code>. Note that non adjacent vertices can still be mapped onto adjacent ones.</p>

<p><code class="code">DigraphHomomorphism</code> returns a single homomorphism between <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var> if it exists, otherwise it returns <code class="keyw">fail</code>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr1 := ChainDigraph(3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := Digraph([[3, 5], [2], [3, 1], [], [4]]);</span>
&lt;digraph with 5 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphHomomorphism(gr1, gr1);</span>
IdentityTransformation
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphHomomorphism(gr1, gr2);</span>
Transformation( [ 1, 3, 1 ] )
</pre></div>

<p><a id="X8653EDA183E06D05" name="X8653EDA183E06D05"></a></p>

<h5>7.3-3 HomomorphismsDigraphs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; HomomorphismsDigraphs</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; HomomorphismsDigraphsRepresentatives</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A list of transformations.</p>

<p><code class="code">HomomorphismsDigraphsRepresentatives</code> finds every <code class="func">DigraphHomomorphism</code> (<a href="chap7_mj.html#X85E9B019877AD7FE"><span class="RefLink">7.3-2</span></a>) between <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var>, up to right multiplication by an element of the <code class="func">AutomorphismGroup</code> (<a href="chap7_mj.html#X858C32127A190175"><span class="RefLink">7.2-2</span></a>) of <var class="Arg">digraph2</var>. In other words, every homomorphism <code class="code">f</code> between <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var> can be written as the composition <code class="code">f = g * x</code>, where <code class="code">g</code> is one of the <code class="code">HomomorphismsDigraphsRepresentatives</code> and <code class="code">x</code> is an automorphism of <var class="Arg">digraph2</var>.</p>

<p><code class="code">HomomorphismsDigraphs</code> returns all homomorphisms between <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr1 := ChainDigraph(3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := Digraph([[3, 5], [2], [3, 1], [], [4]]);</span>
&lt;digraph with 5 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HomomorphismsDigraphs(gr1, gr2);</span>
[ Transformation( [ 1, 3, 1 ] ), Transformation( [ 1, 3, 3 ] ), 
  Transformation( [ 1, 5, 4, 4, 5 ] ), Transformation( [ 2, 2, 2 ] ), 
  Transformation( [ 3, 1, 3 ] ), Transformation( [ 3, 1, 5, 4, 5 ] ), 
  Transformation( [ 3, 3, 1 ] ), Transformation( [ 3, 3, 3 ] ) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">HomomorphismsDigraphsRepresentatives(gr1, CompleteDigraph(3));</span>
[ IdentityTransformation, Transformation( [ 1, 2, 1 ] ) ]
</pre></div>

<p><a id="X82D0FCD87D47ACA8" name="X82D0FCD87D47ACA8"></a></p>

<h5>7.3-4 DigraphMonomorphism</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphMonomorphism</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A transformation, or <code class="keyw">fail</code>.</p>

<p><code class="code">DigraphMonomorphism</code> returns a single <em>injective</em> <code class="func">DigraphHomomorphism</code> (<a href="chap7_mj.html#X85E9B019877AD7FE"><span class="RefLink">7.3-2</span></a>) between <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var> if one exists, otherwise it returns <code class="keyw">fail</code>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr1 := ChainDigraph(3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := Digraph([[3, 5], [2], [3, 1], [], [4]]);</span>
&lt;digraph with 5 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphMonomorphism(gr1, gr1);</span>
IdentityTransformation
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphMonomorphism(gr1, gr2);</span>
Transformation( [ 1, 5, 4, 4, 5 ] )
</pre></div>

<p><a id="X84B4BDB984C2A9A8" name="X84B4BDB984C2A9A8"></a></p>

<h5>7.3-5 MonomorphismsDigraphs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; MonomorphismsDigraphs</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; MonomorphismsDigraphsRepresentatives</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A list of transformations.</p>

<p>These operations behave the same as <code class="func">HomomorphismsDigraphs</code> (<a href="chap7_mj.html#X8653EDA183E06D05"><span class="RefLink">7.3-3</span></a>) and <code class="func">HomomorphismsDigraphsRepresentatives</code> (<a href="chap7_mj.html#X8653EDA183E06D05"><span class="RefLink">7.3-3</span></a>), expect they only return <em>injective</em> homomorphisms.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr1 := ChainDigraph(3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := Digraph([[3, 5], [2], [3, 1], [], [4]]);</span>
&lt;digraph with 5 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">MonomorphismsDigraphs(gr1, gr2);</span>
[ Transformation( [ 1, 5, 4, 4, 5 ] ), 
  Transformation( [ 3, 1, 5, 4, 5 ] ) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">MonomorphismsDigraphsRepresentatives(gr1, CompleteDigraph(3));</span>
[ IdentityTransformation ]
</pre></div>

<p><a id="X7CB5AD9F861684FD" name="X7CB5AD9F861684FD"></a></p>

<h5>7.3-6 DigraphEpimorphism</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphEpimorphism</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A transformation, or <code class="keyw">fail</code>.</p>

<p><code class="code">DigraphEpimorphism</code> returns a single <em>surjective</em> <code class="func">DigraphHomomorphism</code> (<a href="chap7_mj.html#X85E9B019877AD7FE"><span class="RefLink">7.3-2</span></a>) between <var class="Arg">digraph1</var> and <var class="Arg">digraph2</var> if one exists, otherwise it returns <code class="keyw">fail</code>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr1 := DigraphReverse(ChainDigraph(4));</span>
&lt;digraph with 4 vertices, 3 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := DigraphRemoveEdge(CompleteDigraph(3), [1, 2]);</span>
&lt;digraph with 3 vertices, 5 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphEpimorphism(gr2, gr1);</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphEpimorphism(gr1, gr2);</span>
Transformation( [ 1, 2, 3, 1 ] )
</pre></div>

<p><a id="X7DFB1F5D873937B3" name="X7DFB1F5D873937B3"></a></p>

<h5>7.3-7 EpimorphismsDigraphs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; EpimorphismsDigraphs</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; EpimorphismsDigraphsRepresentatives</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A list of transformations.</p>

<p>These operations behave the same as <code class="func">HomomorphismsDigraphs</code> (<a href="chap7_mj.html#X8653EDA183E06D05"><span class="RefLink">7.3-3</span></a>) and <code class="func">HomomorphismsDigraphsRepresentatives</code> (<a href="chap7_mj.html#X8653EDA183E06D05"><span class="RefLink">7.3-3</span></a>), expect they only return <em>surjective</em> homomorphisms.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr1 := DigraphReverse(ChainDigraph(4));</span>
&lt;digraph with 4 vertices, 3 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr2 := DigraphSymmetricClosure(CycleDigraph(3));</span>
&lt;digraph with 3 vertices, 6 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">EpimorphismsDigraphsRepresentatives(gr1, gr2);</span>
[ Transformation( [ 1, 2, 3, 1 ] ), Transformation( [ 1, 2, 3, 2 ] ), 
  Transformation( [ 1, 2, 1, 3 ] ) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">EpimorphismsDigraphs(gr1, gr2);</span>
[ Transformation( [ 1, 2, 1, 3 ] ), Transformation( [ 1, 2, 3, 1 ] ), 
  Transformation( [ 1, 2, 3, 2 ] ), Transformation( [ 1, 3, 1, 2 ] ), 
  Transformation( [ 1, 3, 2, 1 ] ), Transformation( [ 1, 3, 2, 3 ] ), 
  Transformation( [ 2, 1, 2, 3 ] ), Transformation( [ 2, 1, 3, 1 ] ), 
  Transformation( [ 2, 1, 3, 2 ] ), Transformation( [ 2, 3, 1, 2 ] ), 
  Transformation( [ 2, 3, 1, 3 ] ), Transformation( [ 2, 3, 2, 1 ] ), 
  Transformation( [ 3, 1, 2, 1 ] ), Transformation( [ 3, 1, 2, 3 ] ), 
  Transformation( [ 3, 1, 3, 2 ] ), Transformation( [ 3, 2, 1, 2 ] ), 
  Transformation( [ 3, 2, 1, 3 ] ), Transformation( [ 3, 2, 3, 1 ] ) ]
</pre></div>

<p><a id="X7E93B268823F6478" name="X7E93B268823F6478"></a></p>

<h5>7.3-8 GeneratorsOfEndomorphismMonoid</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; GeneratorsOfEndomorphismMonoid</code>( <var class="Arg">digraph</var>[, <var class="Arg">colors</var>][, <var class="Arg">limit</var>] )</td><td class="tdright">( function )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; GeneratorsOfEndomorphismMonoidAttr</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A list of transformations.</p>

<p>An endomorphism of <var class="Arg">digraph</var> is a homomorphism <code class="func">DigraphHomomorphism</code> (<a href="chap7_mj.html#X85E9B019877AD7FE"><span class="RefLink">7.3-2</span></a>) from <var class="Arg">digraph</var> back to itself. <code class="code">GeneratorsOfEndomorphismMonoid</code>, called with a single argument, returns a generating set for the monoid of all endomorphisms of <var class="Arg">digraph</var>.</p>

<p>If the <var class="Arg">colors</var> argument is specified, then it will return a generating set for the monoid of endomorphisms which respect the given colouring. The colouring <var class="Arg">colors</var> can be in one of two forms:</p>


<ul>
<li><p>A list of positive integers of size the number of vertices of <var class="Arg">digraph</var>, where <var class="Arg">colors</var><code class="code">[i]</code> is the colour of vertex <code class="code">i</code>.</p>

</li>
<li><p>A list of lists, such that <var class="Arg">colors</var><code class="code">[i]</code> is a list of all vertices with colour <code class="code">i</code>.</p>

</li>
</ul>
<p>If the <var class="Arg">limit</var> argument is specified, then it will return only the first <var class="Arg">limit</var> homomorphisms, where <var class="Arg">limit</var> must be a positive integer or <code class="code">infinity</code>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := Digraph(List([1 .. 3], x -&gt; [1 .. 3]));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfEndomorphismMonoid(gr);</span>
[ Transformation( [ 1, 3, 2 ] ), Transformation( [ 2, 1 ] ), 
  IdentityTransformation, Transformation( [ 1, 2, 1 ] ), 
  Transformation( [ 1, 2, 2 ] ), Transformation( [ 1, 1, 2 ] ), 
  Transformation( [ 1, 1, 1 ] ) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfEndomorphismMonoid(gr, 3);</span>
[ Transformation( [ 1, 3, 2 ] ), Transformation( [ 2, 1 ] ), 
  IdentityTransformation ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := CompleteDigraph(3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfEndomorphismMonoid(gr);</span>
[ Transformation( [ 1, 3, 2 ] ), Transformation( [ 2, 1 ] ), 
  IdentityTransformation ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfEndomorphismMonoid(gr, [1, 2, 2]);</span>
[ Transformation( [ 1, 3, 2 ] ), IdentityTransformation ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfEndomorphismMonoid(gr, [[1], [2, 3]]);</span>
[ Transformation( [ 1, 3, 2 ] ), IdentityTransformation ]
</pre></div>

<p><a id="X86D0A74B83D6B9A7" name="X86D0A74B83D6B9A7"></a></p>

<h5>7.3-9 DigraphColouring</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphColouring</code>( <var class="Arg">digraph</var>, <var class="Arg">n</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphColoring</code>( <var class="Arg">digraph</var>, <var class="Arg">n</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphColouring</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphColoring</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A transformation, or <code class="keyw">fail</code>.</p>

<p>A <em>proper colouring</em> of a digraph is a labelling of its vertices in such a way that adjacent vertices have different labels. A <em>proper <code class="code">n</code>-colouring</em> is a proper colouring that uses exactly <code class="code">n</code> colours. Equivalently, a proper (<code class="code">n</code>-)colouring of a digraph can be defined to be a <code class="func">DigraphEpimorphism</code> (<a href="chap7_mj.html#X7CB5AD9F861684FD"><span class="RefLink">7.3-6</span></a>) from a digraph onto the complete digraph (with <code class="code">n</code> vertices); see <code class="func">CompleteDigraph</code> (<a href="chap3_mj.html#X812417E278198D9C"><span class="RefLink">3.5-2</span></a>). Note that a digraph with loops (<code class="func">DigraphHasLoops</code> (<a href="chap6_mj.html#X7D92935C7D535187"><span class="RefLink">6.1-1</span></a>)) does not have a proper <code class="code">n</code>-colouring for any value <code class="code">n</code>.</p>

<p>If <var class="Arg">digraph</var> is a digraph and <var class="Arg">n</var> is a non-negative integer, then <code class="code">DigraphColouring(<var class="Arg">digraph</var>, <var class="Arg">n</var>)</code> returns an epimorphism from <var class="Arg">digraph</var> onto the complete digraph with <var class="Arg">n</var> vertices if one exists, else it returns <code class="keyw">fail</code>.</p>

<p>If the optional second argument <var class="Arg">n</var> is not provided, then <code class="code">DigraphColouring</code> uses a greedy algorithm to obtain some proper colouring of <var class="Arg">digraph</var>, which may not use the minimal number of colours.</p>

<p>Note that a digraph with at least two vertices has a 2-colouring if and only if it is bipartite, see <code class="func">IsBipartiteDigraph</code> (<a href="chap6_mj.html#X860CFB0C8665F356"><span class="RefLink">6.1-3</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphColouring(CompleteDigraph(5), 4);</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphColouring(ChainDigraph(10), 1);</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := ChainDigraph(10);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">t := DigraphColouring(gr, 2);</span>
Transformation( [ 1, 2, 1, 2, 1, 2, 1, 2, 1, 2 ] )
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ForAll(DigraphEdges(gr), e -&gt; e[1] ^ t &lt;&gt; e[2] ^ t);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphColouring(gr);</span>
Transformation( [ 1, 2, 1, 2, 1, 2, 1, 2, 1, 2 ] )
</pre></div>

<p><a id="X7AD04CC186E86CCA" name="X7AD04CC186E86CCA"></a></p>

<h5>7.3-10 DigraphEmbedding</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DigraphEmbedding</code>( <var class="Arg">digraph1</var>, <var class="Arg">digraph2</var> )</td><td class="tdright">( operation )</td></tr></table></div>
<p>Returns: A transformation, or <code class="keyw">fail</code>.</p>

<p>An embedding of a digraph <var class="Arg">digraph1</var> into another digraph <var class="Arg">digraph2</var> is a <code class="func">DigraphMonomorphism</code> (<a href="chap7_mj.html#X82D0FCD87D47ACA8"><span class="RefLink">7.3-4</span></a>) from <var class="Arg">digraph1</var> to <var class="Arg">digraph2</var> which has the additional property that a pair of vertices <code class="code">[i, j]</code> which have no edge <code class="code">i -&gt; j</code> in <var class="Arg">digraph1</var> are mapped to a pair of vertices <code class="code">[a, b]</code> which have no edge <code class="code">a-&gt;b</code> in <var class="Arg">digraph2</var>.</p>

<p>In other words, an embedding <code class="code">t</code> is an isomorphism from <var class="Arg">digraph1</var> to the <code class="func">InducedSubdigraph</code> (<a href="chap3_mj.html#X83C51DA182CCEA2F"><span class="RefLink">3.3-2</span></a>) of <var class="Arg">digraph2</var> on the image of <code class="code">t</code>.</p>

<p><code class="code">DigraphEmbedding</code> returns a single embedding if one exists, otherwise it returns <code class="keyw">fail</code>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gr := ChainDigraph(3);</span>
&lt;digraph with 3 vertices, 2 edges&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphEmbedding(gr, CompleteDigraph(4));</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">DigraphEmbedding(gr, Digraph([[3], [1, 4], [1], [3]]));</span>
Transformation( [ 2, 4, 3, 4 ] )
</pre></div>

<p><a id="X807D49358529A37C" name="X807D49358529A37C"></a></p>

<h5>7.3-11 ChromaticNumber</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; ChromaticNumber</code>( <var class="Arg">digraph</var> )</td><td class="tdright">( attribute )</td></tr></table></div>
<p>Returns: A non-negative integer.</p>

<p>A <em>proper colouring</em> of a digraph is a labelling of its vertices in such a way that adjacent vertices have different labels. Equivalently, a proper digraph colouring can be defined to be a <code class="func">DigraphEpimorphism</code> (<a href="chap7_mj.html#X7CB5AD9F861684FD"><span class="RefLink">7.3-6</span></a>) from a digraph onto a complete digraph.</p>

<p>If <var class="Arg">digraph</var> is a digraph without loops (see <code class="func">DigraphHasLoops</code> (<a href="chap6_mj.html#X7D92935C7D535187"><span class="RefLink">6.1-1</span></a>), then <code class="code">ChromaticNumber</code> returns the least non-negative integer <code class="code">n</code> such that there is a proper colouring of <var class="Arg">digraph</var> with <code class="code">n</code> colours. In other words, for a digraph with at least one vertex, <code class="code">ChromaticNumber</code> returns the least number <code class="code">n</code> such that <code class="code">DigraphColouring(<var class="Arg">digraph</var>, n)</code> does not return <code class="keyw">fail</code>. See <code class="func">DigraphColouring</code> (<a href="chap7_mj.html#X86D0A74B83D6B9A7"><span class="RefLink">7.3-9</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ChromaticNumber(NullDigraph(10));</span>
1
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ChromaticNumber(CompleteDigraph(10));</span>
10
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ChromaticNumber(CompleteBipartiteDigraph(5, 5));</span>
2
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ChromaticNumber(Digraph([[], [3], [5], [2, 3], [4]]));</span>
3
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ChromaticNumber(NullDigraph(0));</span>
0</pre></div>


<div class="chlinkprevnextbot">&nbsp;<a href="chap0_mj.html">[Top of Book]</a>&nbsp;  <a href="chap0_mj.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap6_mj.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap8_mj.html">[Next Chapter]</a>&nbsp;  </div>


<div class="chlinkbot"><span class="chlink1">Goto Chapter: </span><a href="chap0_mj.html">Top</a>  <a href="chap1_mj.html">1</a>  <a href="chap2_mj.html">2</a>  <a href="chap3_mj.html">3</a>  <a href="chap4_mj.html">4</a>  <a href="chap5_mj.html">5</a>  <a href="chap6_mj.html">6</a>  <a href="chap7_mj.html">7</a>  <a href="chap8_mj.html">8</a>  <a href="chap9_mj.html">9</a>  <a href="chapA_mj.html">A</a>  <a href="chapBib_mj.html">Bib</a>  <a href="chapInd_mj.html">Ind</a>  </div>

<hr />
<p class="foot">generated by <a href="http://www.math.rwth-aachen.de/~Frank.Luebeck/GAPDoc">GAPDoc2HTML</a></p>
</body>
</html>
